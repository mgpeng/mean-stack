{"version":3,"sources":["webpack:///webpack/bootstrap 32fc6e06fb24e3c627dd","webpack:///external \"passport\"","webpack:///external \"mongoose\"","webpack:///./server-config/config.js","webpack:///./server-src/controllers/users.server.controller.js","webpack:///external \"url\"","webpack:///./server.js","webpack:///(webpack)/buildin/module.js","webpack:///./server-config/mongoose.js","webpack:///./server-config/env ^\\.\\/.*\\.js$","webpack:///./server-config/env/development.js","webpack:///./server-config/env/production.js","webpack:///./server-config/env/test.js","webpack:///./server-src/models/user.server.model.js","webpack:///external \"crypto\"","webpack:///./server-src/models/article.server.model.js","webpack:///./server-config/express.js","webpack:///external \"path\"","webpack:///external \"http\"","webpack:///external \"socket.io\"","webpack:///external \"express\"","webpack:///external \"morgan\"","webpack:///external \"compression\"","webpack:///external \"body-parser\"","webpack:///external \"method-override\"","webpack:///external \"express-session\"","webpack:///external \"connect-mongo\"","webpack:///./server-config/socketio.js","webpack:///external \"cookie-parser\"","webpack:///./server-src/controllers/chat.server.controller.js","webpack:///external \"connect-flash\"","webpack:///./server-src/routes/users.server.routes.js","webpack:///./server-src/routes/articles.server.routes.js","webpack:///./server-src/controllers/articles.server.controller.js","webpack:///./server-src/routes/index.server.routes.js","webpack:///./server-src/controllers/index.server.controller.js","webpack:///./server-config/passport.js","webpack:///./server-config/strategies/local.js","webpack:///external \"passport-local\"","webpack:///./server-config/strategies/facebook.js","webpack:///external \"passport-facebook\"","webpack:///./server-config/strategies/twitter.js","webpack:///external \"passport-twitter\"","webpack:///./server-config/strategies/google.js","webpack:///external \"passport-google-oauth\""],"names":[],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AC7DA,qC;;;;;;ACAA,qC;;;;;;ACAA,yE;;;;;;ACAA;AACA;;AAEA;AACA;AACA,qCAAqC,gCAAgC;AACrE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,YAAY;AACZ,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,gBAAgB;AAChB;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL,E;;;;;;AC9MA,gC;;;;;;ACAA;;AAEA,iDAA8D;AAC9D;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,+C;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;ACrBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR,E;;;;;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sB;;;;;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,E;;;;;;ACnBA;;AAEA,E;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,E;;;;;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA,mBAAmB;AACnB;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,0BAA0B,yCAAyC;AACnE;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,0BAA0B;AAC5C;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA,yBAAyB,2BAA2B;AACpD;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;ACxGA,mC;;;;;;ACAA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,CAAC;AACD,wC;;;;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA,qCAAqC,iCAAiC;AACtE;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,C;;;;;;AC3DA,iC;;;;;;ACAA,iC;;;;;;ACAA,sC;;;;;;ACAA,oC;;;;;;ACAA,mC;;;;;;ACAA,wC;;;;;;ACAA,wC;;;;;;ACAA,4C;;;;;;ACAA,4C;;;;;;ACAA,0C;;;;;;ACAA;AACA;AACA;AACA;;AAEA;AACA;AACA,yDAAyD;AACzD;;AAEA;AACA;;AAEA,gDAAgD;AAChD,4BAA4B,qCAAqC;AACjE;AACA;AACA,iCAAiC;AACjC;AACA;AACA,8BAA8B;AAC9B,2BAA2B;AAC3B,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA;AACA,GAAG;AACH,E;;;;;;AC5BA,0C;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH,E;;;;;;ACxBA,0C;;;;;;ACAA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL,E;;;;;;ACnEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,E;;;;;;ACdA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,gBAAgB;AAChB;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,6BAA6B;AACtE,SAAS;AACT;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,yCAAyC,6BAA6B;AACtE,SAAS;AACT;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,qCAAqC,iCAAiC;AACtE;AACA;AACA,E;;;;;;ACtFA;AACA;AACA;AACA;AACA,E;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,E;;;;;;AClBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,OAAO;AAC7B;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA,E;;;;;;ACnBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,SAAS;AACT,KAAK;AACL,E;;;;;;ACzBA,2C;;;;;;ACAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH,E;;;;;;AC/BA,8C;;;;;;ACAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH,E;;;;;;AC3BA,6C;;;;;;ACAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;;;;;;AC9BA,kD","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 32fc6e06fb24e3c627dd","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 1\n// module chunks = 0","module.exports = require('./env/'+process.env.NODE_ENV+'.js');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/config.js\n// module id = 2\n// module chunks = 0","const User= require('mongoose').model('User');\nconst passport = require('passport');\n\nexports.requireLogin=(req,res,next)=>{\n    if(!req.isAuthenticated){\n        return res.status(401).send({message:'User is not logged in'});\n    }\n    next();\n};\n\nexports.saveOAuthUserProfile = function(req, profile, done) {\n  User.findOne({\n    provider: profile.provider,\n    providerId: profile.providerId\n  }, function(err, user) {\n    if (err) {\n      return done(err);\n    } else {\n      if (!user) {\n        const possibleUsername = profile.username ||\n        ((profile.email) ? profile.email.split('@')[0] : '');\n\n        User.findUniqueUsername(possibleUsername, null,\n        function(availableUsername) {\n          profile.username = availableUsername;\n\n          user = new User(profile);\n          user.save((err) => {\n            if (err) {\n              const message = _this.getErrorMessage(err);\n              console.log(\"Check _this meaning\");\n              console.log(_this);\n              req.flash('error', message);\n              return res.redirect('/signup');\n            }\n\n            return done(err, user);\n          });\n        });\n      } else {\n        return done(err, user);\n      }\n    }\n  });\n};\n\ngetErrorMessage=(err)=>{\n    let message='';\n    if (err.code){\n        switch(err.code){\n            case 11000:\n            case 11001:\n               message='Username already exists';\n               break;\n            default:\n               message='Something went wrong';\n        }\n    }else{\n        for (let errName in err.errors){\n            if (err.errors[errName].message)\n                 message=err.errors[errName].message;\n        }\n    }\n    console.log('Error message in getErrorMessage');\n    console.log(message);\n    return message;\n};\nexports.renderSignin=(req,res,next)=>{\n    if(!req.user){\n        res.render('signin',{\n                   title:'Sign-in form',\n                   messages:req.flash('error')||req.flash('info')\n                });\n    }else{\n        return res.redirect('/');\n    }\n};\nexports.renderSignup=(req,res,next)=>{\n    if(!req.user){\n        res.render('signup',{\n                   title:'Sign-up form',\n                   messages:req.flash('error')\n                });\n    }else{\n        return res.redirect('/');\n    }\n};\nexports.signin=(req,res,next)=>{\n    passport.authenticate('local',(err,user,info)=>{\n        if(err||!user){\n            res.status(400).send(info);\n        }else{\n            user.password=undefined;\n            user.salt=undefined;\n            req.login(user,(err)=>{\n               if(err){\n                res.status(400).send(err);\n               }else{\n                res.json(user);\n               }\n            });\n        }\n    })(req,res,next);\n};\n// exports.signup=(req,res,next)=>{\n    // if(!req.user){\n    //     const user=new User(req.body);\n    //     user.provider='local';\n    //     user.save((err)=>{\n    //         if(err){\n    //             const message=getErrorMessage(err);\n    //             req.flash('error',message);\n    //             return res.redirect('/signup');\n    //         }\n    //         req.login(user,(err)=>{\n    //             if(err) return next(err);\n    //             return res.redirect('/');\n    //         });\n    //     });\n    // }else{\n    //     return res.redirect('/');\n    // }\n// };\nexports.signup = function(req, res) {\n  const user = new User(req.body);\n  user.provider = 'local';\n\n  user.save((err) => {\n    if (err) {\n      return res.status(400).send({\n        message: getErrorMessage(err)\n      });\n    } else {\n      // Remove sensitive data before login\n      user.password = undefined;\n      user.salt = undefined;\n\n      req.login(user, function(err) {\n        if (err) {\n          res.status(400).send(err);\n        } else {\n          res.json(user);\n        }\n      });\n    }\n  });\n};\n\nexports.signout=(req,res)=>{\n    req.logout();\n    res.redirect('/');\n};\n\n\nexports.create=(req,res,next)=>{\n    const user=new User(req.body);\n    user.save((err)=>{\n        if (err){\n            return next(err);\n        }else{\n            res.status(200).json(user);\n        }\n    });\n};\nexports.list=(req,res,next)=>{\n    User.find({},(err,data)=>{\n        if (err){\n            return next(err);\n        }else{\n            res.status(200).json(data);\n        }\n    })\n}\nexports.read=(req,res)=>{\n    res.json(req.user);\n};\nexports.userByID=(req,res,next,id)=>{\n    User.findOne({\n        _id:id\n    },(err,user)=>{\n        if (err){\n            return next(err);\n        }else{\n            req.user=user;\n            next();\n        }\n    });\n};\nexports.update=(req,res,next)=>{\n    User.findByIdAndUpdate(req.user.id,req.body,{\n        'new':true},(err,user)=>{\n            if (err){\n                return next(err);\n            }else{\n                res.status(200).json(user);\n            }\n    });\n};\nexports.delete=(req,res,next)=>{\n    req.user.remove((err,user)=>{\n            if (err){\n                return next(err);\n            }else{\n                res.status(200).json(user);\n            }\n    });\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-src/controllers/users.server.controller.js\n// module id = 3\n// module chunks = 0","module.exports = require(\"url\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"url\"\n// module id = 4\n// module chunks = 0","process.env.NODE_ENV = process.env.NODE_ENV || 'development';\n\nconst configureMongoose = require('./server-config/mongoose');  //--  mongoose should be load first\nconst configureExpress=require('./server-config/express.js');\nconst configurePassport=require('./server-config/passport.js');\n\nconst db=configureMongoose();\nconst app=configureExpress(db);\nconst passport=configurePassport();\n\napp.listen(3000);\nmodule.exprots = app;\nconsole.log(\"Express app runing in port 3000\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server.js\n// module id = 5\n// module chunks = 0","module.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/module.js\n// module id = 6\n// module chunks = 0","const config = require('./config');\nconst mongoose = require('mongoose');\n\nmodule.exports = function(){\n    mongoose.Promise = global.Promise;\n    const db = mongoose.connect(config.db);\n    require('../server-src/models/user.server.model');\n    require('../server-src/models/article.server.model');\n    return db;\n    // dbconn=mongoose.connection;\n    // dbconn.on('error',console.error.bind(console,'connection database error !'));\n    // dbconn.once('open',()=>{\n    //     return db;\n    // });\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/mongoose.js\n// module id = 7\n// module chunks = 0","var map = {\n\t\"./development.js\": 9,\n\t\"./production.js\": 10,\n\t\"./test.js\": 11\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 8;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/env ^\\.\\/.*\\.js$\n// module id = 8\n// module chunks = 0","module.exports = {\n  db:'mongodb://localhost/mean',\n  sessionSecret:'developmentSessionSecretString',\n  viewEngine: 'ejs',\n  facebook: {\n    clientID: '197836114050020',\n    clientSecret: 'aeca2aa61f62b08ea08b1780cba491d4',\n    callbackURL: 'http://localhost:3000/api/oauth/facebook/callback'\n  },\n  twitter: {\n    clientID: '08h4XzUCu8c3g5RfhSAuQjquP',\n    clientSecret: 'S8ZKzLkCPPy2bFHSjvMXnUqA6QMLQsRULwQ5eJ8u3mfbdovmED',\n    callbackURL: 'http://localhost:3000/api/oauth/twitter/callback'\n  },\n  google: {\n    clientID: '842162122191-sdv3ue976kjcq9as2o4ki5pg39a6ct0o.apps.googleusercontent.com',\n    clientSecret: 'tc_k6kL9B9PmeCwy70wW3TLT',\n    callbackURL: 'http://localhost:3000/api/oauth/google/callback'\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/env/development.js\n// module id = 9\n// module chunks = 0","module.exports = {\n\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/env/production.js\n// module id = 10\n// module chunks = 0","module.exports = {\n  db:'mongodb://localhost/mean-test',\n  sessionSecret:'developmentSessionSecretString',\n  viewEngine: 'ejs',\n  facebook: {\n    clientID: '197836114050020',\n    clientSecret: 'aeca2aa61f62b08ea08b1780cba491d4',\n    callbackURL: 'http://localhost:3000/api/oauth/facebook/callback'\n  },\n  twitter: {\n    clientID: '08h4XzUCu8c3g5RfhSAuQjquP',\n    clientSecret: 'S8ZKzLkCPPy2bFHSjvMXnUqA6QMLQsRULwQ5eJ8u3mfbdovmED',\n    callbackURL: 'http://localhost:3000/api/oauth/twitter/callback'\n  },\n  google: {\n    clientID: '842162122191-sdv3ue976kjcq9as2o4ki5pg39a6ct0o.apps.googleusercontent.com',\n    clientSecret: 'tc_k6kL9B9PmeCwy70wW3TLT',\n    callbackURL: 'http://localhost:3000/api/oauth/google/callback'\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/env/test.js\n// module id = 11\n// module chunks = 0","const mongoose=require('mongoose');\nconst crypto=require('crypto');\nconst Schema= mongoose.Schema;\nconst UserSchema=new Schema({\n    firstName:String,\n    lastName:String,\n    email:{\n        type:String,\n        match:[/.+\\@.+\\..+/,\"Please fill a valid e-mail address\"]\n    },\n    username:{\n        type:String,\n        trim:true,\n        unique:true,\n        required:'Username is required'\n    },\n    password:{\n        type:String,\n        validate:[(password)=>{\n            return password && password.length>6;\n        },'Password should be longer']\n    },\n    salt:{\n        type:String\n    },\n    provider:{\n        type:String,\n        required:'Provider is required'\n    },\n    providerId:String,\n    providerData:{},\n    created:{\n        type:Date,\n        default:Date.now\n    },\n    website:{\n        type:String,\n        get: (url)=>{\n            if (!url){\n                // url=\"Empty Url\";\n                return url;\n            }else{\n                if(url.indexOf('http://')!==0 && url.indexOf('https://')!==0){\n                    url='http://'+url;\n                }\n            }\n            return url;\n        }\n    }\n});\nUserSchema.virtual('fullName')\n          .get(function(){return this.firstName+' '+this.lastName;})\n          .set(function(fullName){\n              const splitName=fullName.split(' ');\n              this.firstName=splitName[0] || '';\n              this.lastName=splitName[1] || '';\n          });\nUserSchema.pre('save',function(next){\n    if (this.password){\n        this.salt=new Buffer(crypto.randomBytes(16).toString('base64'),'base64');\n        this.password=this.hashPassword(this.password);\n    }\n    next();\n});\nUserSchema.methods.hashPassword=function(password){\n    return crypto.pbkdf2Sync(password,this.salt,10000,64).toString('base64');\n};\nUserSchema.methods.authenticate=function(password){\n    console.log('inside UserSchema.methods.authenticate check this keyword');\n    console.log(this);\n    return this.password === this.hashPassword(password);\n};\nUserSchema.statics.findUniqueUsername=function(username,suffix,callback){\n    var possibleUsername=username+(suffix||'');\n    console.log('inside UserSchema.statics.findUniqueUsername  check this keyword');\n    console.log(this);\n    this.findOne({username:possibleUsername},(err,user)=>{\n        if(!err){\n            if (!user){\n                callback(possibleUsername);\n            }else{\n                return this.findUniqueUsername(username,(suffic||0)+1,callback);\n            }\n        }else{\n            callback(null);\n        }\n    });\n};\nUserSchema.set('toJSON',{getters:true,virtuals:true});\nmongoose.model('User',UserSchema);\nconst PostSchema=new Schema({\n    title:{\n        type:String,\n        required:true\n    },\n    content:{\n        type:String,\n        required:true\n    },\n    author:{\n        type:Schema.ObjectId,\n        ref:'User'\n    }\n});\nmongoose.model('Post',PostSchema);\n\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-src/models/user.server.model.js\n// module id = 12\n// module chunks = 0","module.exports = require(\"crypto\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"crypto\"\n// module id = 13\n// module chunks = 0","const mongoose=require('mongoose');\nconst Schema=mongoose.Schema;\n\nconst ArticleSchema=new Schema({\n    created:{\n        type:Date,\n        default:Date.now\n    },\n    title:{\n        type:String,\n        default:'',\n        trim:true,\n        required:'Title can\\'t be blank'\n    },\n    content:{\n        type:String,\n        default:'',\n        trim:true\n    },\n    creator:{\n        type:Schema.ObjectId,\n        ref:'User'\n    }\n});\nmongoose.model('Article',ArticleSchema);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-src/models/article.server.model.js\n// module id = 14\n// module chunks = 0","const path = require('path')\nconst config = require('./config');\nconst http=require('http');\nconst socketio=require('socket.io');\nconst express = require('express');\nconst morgan = require('morgan');\nconst compress = require('compression');\nconst bodyParser = require('body-parser');\nconst methodOverride = require('method-override');\nconst session = require('express-session');\nconst MongoStore=require('connect-mongo')(session);\nconst passport=require('passport');\nconst configureSocket = require('./socketio');\nconst flash= require('connect-flash');\n\nmodule.exports = (db)=>{\n    const app=express();\n    const server=http.createServer(app);\n    const io=socketio.listen(server);\n\n    if (process.env.NODE_ENV === 'development'){\n        app.use(morgan('dev'));\n    }else if (process.env.NODE_ENV === 'production') {\n        app.use(compress());\n    }\n    app.use(bodyParser.urlencoded({\n        extended:true\n    }));\n    app.use(bodyParser.json());\n    app.use(methodOverride());\n    \n    const mongoStore=new MongoStore({mongooseConnection:db.connection});\n    app.use(session({\n        saveUninitialized:true,\n        resave:true,\n        secret:config.sessionSecret,\n        store:mongoStore\n    }))\n\n    // app.set('views','./app/views');\n    // app.set('views','./client-src/dist');\n    app.set('views','./dist');\n    app.set('view engine','ejs');\n    \n    app.use(flash());\n    app.use(passport.initialize());\n    app.use(passport.session());\n\n    // app.use('/', express.static(path.resolve('./cleint-src')));\n    app.use('/', express.static(path.resolve('./dist')));\n    app.use('/lib', express.static(path.resolve('./node_modules')));\n\n    require('../server-src/routes/users.server.routes')(app);\n    require('../server-src/routes/articles.server.routes')(app);\n    require('../server-src/routes/index.server.routes')(app);\n\n    configureSocket(server, io, mongoStore);\n\n    return server;\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/express.js\n// module id = 15\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 20\n// module chunks = 0","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = 21\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 22\n// module chunks = 0","module.exports = require(\"method-override\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"method-override\"\n// module id = 23\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 24\n// module chunks = 0","module.exports = require(\"connect-mongo\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-mongo\"\n// module id = 25\n// module chunks = 0","const config = require('./config');\nconst cookieParser = require('cookie-parser');\nconst passport = require('passport');\nconst configureChat = require('../server-src/controllers/chat.server.controller');\n\nmodule.exports = function(server, io, mongoStore) {\n  io.use((socket, next) => {\n    cookieParser(config.sessionSecret)(socket.request, {}, (err) => {\n      const sessionId = socket.request.signedCookies['connect.sid'];\n\n      mongoStore.get(sessionId, (err, session) => {\n        socket.request.session = session;\n\n        passport.initialize()(socket.request, {}, \n                     () => {passport.session()(socket.request, {}, () => {\n                                if (socket.request.user) {\n                                next(null, true);\n                                } else {\n                                next(new Error('User is not authenticated'), false);\n                                }\n                             })\n                          });\n      });\n    });\n  });\n  io.on('connection', (socket) => {\n    configureChat(io, socket);\n  });\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/socketio.js\n// module id = 26\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 27\n// module chunks = 0","module.exports = function(io, socket) {\n  io.emit('chatMessage', {\n    type: 'status',\n    text: 'connected',\n    created: Date.now(),\n    username: socket.request.user.username\n  });\n\n  socket.on('chatMessage', (message) => {\n    message.type = 'message';\n    message.created = Date.now();\n    message.username = socket.request.user.username;\n\n    io.emit('chatMessage', message);\n  });\n\n  socket.on('disconnect', () => {\n    io.emit('chatMessage', {\n    type: 'status',\n    text: 'disconnected',\n    created: Date.now(),\n    username: socket.request.user.username\n    });\n  });\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-src/controllers/chat.server.controller.js\n// module id = 28\n// module chunks = 0","module.exports = require(\"connect-flash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-flash\"\n// module id = 29\n// module chunks = 0","const users=require('../../server-src/controllers/users.server.controller');\nconst passport = require('passport');\n\nmodule.exports=(app)=>{\n    app.route('/users')\n        .post(users.create)\n        .get(users.list);\n        \n    app.route('/users/:userId')\n        .get(users.read)\n        .put(users.update)\n        .delete(users.delete);\n        \n    app.param('userId',users.userByID);\n\n    app.route('/api/auth/signup')\n    //    .get(users.renderSignup)\n       .post(users.signup);\n\n    app.route('/api/auth/signin')\n    //    .get(users.renderSignin)\n       .post(passport.authenticate('local',{\n                successRedirect:'/',\n                failureRedirect:'/signin',\n                failureFlash:true\n       }));\n    app.get('/api/auth/signout',users.signout);\n\n    app.get('/api/oauth/facebook', passport.authenticate('facebook', {\n        failureRedirect: '/signin'\n    }));\n\n    app.get('/api/oauth/facebook/callback', passport.authenticate('facebook', {\n        failureRedirect: '/signin',\n        successRedirect: '/'\n    }));\n\n    app.get('/api/oauth/twitter', passport.authenticate('twitter', {\n        failureRedirect: '/signin'\n    }));\n\n    app.get('/api/oauth/twitter/callback', passport.authenticate('twitter', {\n        failureRedirect: '/signin',\n        successRedirect: '/'\n    }));\n\n    app.get('/api/oauth/google', passport.authenticate('google', {\n        failureRedirect: '/signin',\n        scope: [\n            'https://www.googleapis.com/auth/userinfo.profile',\n            'https://www.googleapis.com/auth/userinfo.email'\n        ]\n    }),function(req, res) {\n\n   //***HERE this causes that error\n              //cookies.setCookie(res, 'NAME', 'VALUE');\n   //\n    \n  \tconsole.log(\"Google Login successfull\");\n\n    res.redirect('/');}\n    );\n\n    app.get('/api/oauth/google/callback', passport.authenticate('google', {\n        failureRedirect: '/signin',\n        successRedirect: '/'\n    }));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-src/routes/users.server.routes.js\n// module id = 30\n// module chunks = 0","const users=require('../../server-src/controllers/users.server.controller');\nconst articles=require('../../server-src/controllers/articles.server.controller');\n\nmodule.exports=(app)=>{\n    app.route('/api/articles')\n       .get(articles.list)\n       .post(users.requireLogin,articles.create);\n    \n    app.route('/api/articles/:articleId')\n       .get(articles.read)\n       .put(users.requireLogin,articles.hasAuthorization,articles.update)\n       .delete(users.requireLogin,articles.hasAuthorization,articles.delete);\n    \n    app.param('articleId',articles.articleByID);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-src/routes/articles.server.routes.js\n// module id = 31\n// module chunks = 0","const Article=require('mongoose').model('Article');\n\ngetErrorMessage=(err)=>{\n    if(err.errors){\n        for (let errName in err.errors){\n            if (err.errors[errName].message) \n                return err.errors[errName].message ;\n        }\n    }else{\n        return 'Unknown server error';\n    }\n};\n\nexports.create=(req,res)=>{\n    const article=new Article(req.body);\n    article.creator=req.user;\n    article.save((err)=>{\n        if(err){\n            return res.status(400).sent({\n                message:getErrorMessage(err)\n            });\n        }else{\n            res.status(200).json(article);\n        }\n    });\n};\n\nexports.list=(req,res)=>{\n    Article.find().sort('-created')\n           .populate('creator','firstName lastName fullName')\n           .exec((err,articles)=>{\n               if(err){\n                   return res.status(400).send({\n                    message:getErrorMessage(err)\n                   });\n               }else{\n                   res.status(200).json(articles);\n               }\n           });\n};\n\nexports.articleByID=(req,res,next,id)=>{\n    Article.findById(id)\n           .populate('creator','firstName lastName fullName')\n           .exec((err,article)=>{\n                if (err) return next(err);\n                if (!article) \n                         return next(new Error('Failed to load article '+id));\n                req.article=article;\n                next();\n            });\n};\n\nexports.read=(req,res)=>{\n    res.status(200).json(req.article);\n};\n\nexports.update=(req,res)=>{\n    const article=req.article;\n    article.title=req.body.title;\n    article.content=req.body.content;\n    article.save((err)=>{\n        if(err){\n            return res.status(400).send({message:getErrorMessage(err)});\n        }else{\n            res.status(200).json(article);\n        }\n    });\n};\n\nexports.delete=(req,res)=>{\n    const article=req.article;\n    article.remove((err)=>{\n        if(err){\n            return res.status(400).send({message:getErrorMessage(err)});\n        }else{\n            res.status(200).json(article);\n        }\n    });\n};\n\nexports.hasAuthorization=(req,res,next)=>{\n    if(req.article.creator.id!==req.user.id){\n        return res.status(403).send({message:'User is not authorized'});\n    }\n    next();\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-src/controllers/articles.server.controller.js\n// module id = 32\n// module chunks = 0","module.exports = (app) => {\n    const index=require('../controllers/index.server.controller');\n    // app.get('/',index.render);\n    app.get('/*',index.render);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-src/routes/index.server.routes.js\n// module id = 33\n// module chunks = 0","exports.render = (req,res) => {\n    if (req.session.lastVisit){\n        console.log(req.session);\n        console.log(\"Show session: \"+req.session.lastVisit);\n    }\n    req.session.lastVisit = new Date();\n    \n    const user = (!req.user) ? null : {\n        _id:req.user.id,\n        firstName:req.user.firstName,\n        lastName:req.user.lastName\n    }\n    res.render('index',{\n               title:'World',\n               subtitle:'Hello Jiangxi',\n               userFullName: req.user ? req.user.fullName : 'None',\n               user:JSON.stringify(user)\n        });\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-src/controllers/index.server.controller.js\n// module id = 34\n// module chunks = 0","const passport=require('passport');\nconst mongoose=require('mongoose');\n\nmodule.exports=()=>{\n    const User=mongoose.model('User');\n    passport.serializeUser((user,done)=>{\n        console.log('inside passport serializeUser');\n        done(null,user.id);\n    });\n    passport.deserializeUser((id,done)=>{\n        User.findOne({_id:id},'-password -salt',(err,user)=>{\n            console.log('inside passport deserializeUser');\n            done(err,user);\n        });\n    });\n    require('./strategies/local.js')();\n    require('./strategies/facebook.js')();\n    require('./strategies/twitter.js')();\n    require('./strategies/google.js')();\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/passport.js\n// module id = 35\n// module chunks = 0","const passport=require('passport');\nconst LocalStrategy=require('passport-local').Strategy;\nconst User=require('mongoose').model('User');\n\nmodule.exports=()=>{\n    passport.use(new LocalStrategy((username,password,done)=>{\n        User.findOne({\n            username:username\n        },(err,user)=>{\n            if (err){\n                return done(err);\n            }\n            if (!user){\n                return done(null,false,{\n                    message:'Unknown user'\n                });\n            }\n            if(!user.authenticate(password)){\n                return done(null,false,{\n                    message:'Invalid password'\n                });\n            }\n            return done(null,user);\n        });\n    }));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/strategies/local.js\n// module id = 36\n// module chunks = 0","module.exports = require(\"passport-local\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-local\"\n// module id = 37\n// module chunks = 0","const passport = require('passport');\nconst url = require('url');\nconst FacebookStrategy = require('passport-facebook').Strategy;\nconst config = require('../config');\nconst users = require('../../server-src/controllers/users.server.controller');\n\nmodule.exports = function() {\n  passport.use(new FacebookStrategy({\n    clientID: config.facebook.clientID,\n    clientSecret: config.facebook.clientSecret,\n    callbackURL: config.facebook.callbackURL,\n    profileFields: ['id', 'name', 'displayName', 'emails'],\n    passReqToCallback: true\n  }, (req, accessToken, refreshToken, profile, done) => {\n    const providerData = profile._json;\n    providerData.accessToken = accessToken;\n    providerData.refreshToken = refreshToken;\n\n    const providerUserProfile = {\n      firstName: profile.name.givenName,\n      lastName: profile.name.familyName,\n      fullName: profile.displayName,\n      email: profile.emails,\n      username: profile.name.givenName + profile.name.familyName,\n      provider: 'facebook',\n      providerId: profile.id,\n      providerData: providerData\n    };\n    \n    users.saveOAuthUserProfile(req, providerUserProfile, done);\n  }));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/strategies/facebook.js\n// module id = 38\n// module chunks = 0","module.exports = require(\"passport-facebook\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-facebook\"\n// module id = 39\n// module chunks = 0","const passport = require('passport');\nconst url = require('url');\nconst TwitterStrategy = require('passport-twitter').Strategy;\nconst config = require('../config');\nconst users = require('../../server-src/controllers/users.server.controller');\n\nmodule.exports = function() {\n  passport.use(new TwitterStrategy({\n    consumerKey: config.twitter.clientID,\n    consumerSecret: config.twitter.clientSecret,\n    callbackURL: config.twitter.callbackURL,\n    passReqToCallback: true\n  }, (req, token, tokenSecret, profile, done) => {\n    const providerData = profile._json;\n    providerData.token = token;\n    providerData.tokenSecret = tokenSecret;\n\n    const providerUserProfile = {\n      fullName: profile.displayName,\n      username: profile.username,\n      provider: 'twitter',\n      providerId: profile.id,\n      providerData: providerData\n    };\n\n    users.saveOAuthUserProfile(req, providerUserProfile, done);\n  }));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/strategies/twitter.js\n// module id = 40\n// module chunks = 0","module.exports = require(\"passport-twitter\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-twitter\"\n// module id = 41\n// module chunks = 0","const passport = require('passport');\nconst url = require('url');\nconst GoogleStrategy = require('passport-google-oauth').OAuth2Strategy;\nconst config = require('../config');\nconst users = require('../../server-src/controllers/users.server.controller');\n\nmodule.exports = function() {\n  passport.use(new GoogleStrategy({\n    clientID: config.google.clientID,\n    clientSecret: config.google.clientSecret,\n    callbackURL: config.google.callbackURL,\n    passReqToCallback: true\n  }, (req, accessToken, refreshToken, profile, done) => {\n    const providerData = profile._json;\n    providerData.accessToken = accessToken;\n    providerData.refreshToken = refreshToken;\nconsole.log('inside google.js before users.saveOAuthUserProfile');\n    const providerUserProfile = {\n      firstName: profile.name.givenName,\n      lastName: profile.name.familyName,\n      fullName: profile.displayName,\n      email: profile.emails[0].value,\n      username: profile.username,\n      provider: 'google',\n      providerId: profile.id,\n      providerData: providerData\n    };\n    \n    users.saveOAuthUserProfile(req, providerUserProfile, done);\n  }));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server-config/strategies/google.js\n// module id = 42\n// module chunks = 0","module.exports = require(\"passport-google-oauth\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-google-oauth\"\n// module id = 43\n// module chunks = 0"],"sourceRoot":""}